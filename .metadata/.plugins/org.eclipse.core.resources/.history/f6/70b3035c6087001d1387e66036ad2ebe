package jdbcapp;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.Statement;
import java.util.Scanner;

//Step1: Load driver
//Step2: connection establishment
//step3: statement deceleration
//step4: write and process query
//step5: close connection and open loop


public class statementwithscanner {

	public static void main(String[] args) throws ClassNotFoundException {
//		Step1: Load driver
		try {
		Class.forName("oracle.jdbc.driver.OracleDriver");
		System.out.println("driver loaded sucessfully..!");
// Step2: Connection with DB
		Connection connection = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "System", "manager");
		System.out.println("connection established successfully..!");
		
// Step3: Statement deceleration 
		Statement statement = connection.createStatement();
		
		Scanner sc = new Scanner(System.in);
		
		while(true) {
			System.out.println("Enter employee id : ");
			int empid = sc.nextInt();
			System.out.println("Enter employee name: ");
			String ename = sc.next();
			System.out.println("enter employee salary: ");
			double esalary = sc.nextDouble();
			
//			statement.executeUpdate("insert into emp values(11,'asdf',565555)");
			String q = "insert into emp values("+empid+",'"+ename+"',"+esalary+" )";
			statement.executeUpdate(q);
			System.out.println("New entry updated successfully..!");
			
		}
		
		
		}
		catch(Exception e) {
			e.printStackTrace();
		}
		finally {
			
		}
	}

}
